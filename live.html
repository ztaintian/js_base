@{

}

<link rel="stylesheet" type="text/css" href="~/Content/OCTTemplet/mob/Style/Live/Live1.css?v=3" />
<link href="~/Scripts/videojs7/video-js.min.css" rel="stylesheet" />
<style>
* {
    margin:0;
    padding:0;
}
#liveplayer {
    width:100%;
    height:9rem;
}
.top {
    background: #fff;
    padding: 0.5rem 0.6rem;
    font-size: 0.6rem;
}
.top-title {
    display:flex;
    background: #fff;
}
.p2 {
    width: 4rem;
    justify-content: flex-end;
    align-items: center;
    display: flex;
}
.p2 span {
    border: 1px solid #eee;
    padding: 0.2rem 0.5rem;
    border-radius: 0.5rem;
}
.top-title .p1 {
    color:#000;
    font-weight:bold;
    overflow: hidden;    
    display: -webkit-box;               
    text-overflow: ellipsis;           
    -webkit-box-orient: vertical;      
    -webkit-line-clamp: 2;  
    flex: 1;
}
.top-time {
    margin-top: 0.5rem;
    display: flex;
    justify-content: space-between;
}
.start-time {
    padding: 0.2rem 0.4rem;
    border: 1px solid #3E7AE9;
    color: #3E7AE9;
    border-radius: 2rem;
}
.room {
    padding: 0.2rem 0;   
}
.middle {
    margin: 0.5rem 0;
    background:#fff;
    padding: 0 0.5rem;
    overflow: hidden;
}
.hot-img {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-size: 0.4rem;
}
.img-css {
    height:1rem;
    weight:1rem;
}
.right {
    display: flex;
    float: right;
    margin-top: 0.2rem;
}
.brief-introduction {
    display:inline-block;
    font-size: 0.6rem;
    height:1.5rem;
    width: 3rem;
    color: #3E7AE9;
    text-align: center;
}
.active-border {
    border-bottom: 2px solid #3E7AE9;
}
.mtR1 {
    margin-right:1rem;
}
.article-padding {
    width:15.19rem;
    margin:0 auto;
}
.article {
    font-size: 0.5rem;
    background:#fff;
}
.article-title {
    font-size: 0.8rem;
    padding: 0 0.5rem;
    line-height:2rem;
    font-weight: bold;
    border-bottom:1px solid #eee;
}
.article-text {
    padding: 0.5rem;
}
  .talk_input {
    display: flex;
    width: 100%;
    position: absolute;
    bottom: 0;
    justify-content: center;
    align-items: center;
    height: 2.34rem;
    background:#E5E5E5;
  }   
  .talk_word {
    height: 1.5rem;
    width:11.33rem;
    padding: 0px;
    outline: none;
    border:none;
    font-size:0.6rem;
    border-radius:0.75rem;
    text-align: center;
  }



  .talk_show {
    width: 100%;
    overflow: auto;
    box-sizing: border-box;
    font-size: 0.6rem;
    padding: 0 0 3rem 0;
  }

  .talk_sub {
    height: 1.5rem;
    width: 2.84rem;
    float: left;
    outline: none;
    border:none;
    background:#4DE9C9;
    color:#fff;
    border-radius:0.75rem;
    font-size: 0.6rem;
    margin-left: 0.4rem;
  }
  .talk_con {
    width: 100%;
  }
  .atalk {
    margin: 0.2rem;
  }
  .talk-name {
    display: block;
    margin: 0.4rem 0 0.2rem;
    color:#3D8CE9;
  }
  .atalk .content {
    display: inline-block;
    background: #fff;
    border-radius: 0 0.64rem 0.64rem 0.85rem;
    color: #000;
    line-height:1.45rem; 
    padding: 0 1rem 0 0.42rem;
  }

  .btalk {
    margin: 0.2rem;
    text-align: right;
  }
  .btalk .content {
    display: inline-block;
    background: #fff;
    border-radius: 0.64rem 0 0.85rem 0.64rem;
    color: #000;
    line-height:1.45rem; 
    padding: 0 0.42rem 0 1rem;
  }
  .video-js .vjs-big-play-button{ display: none; }
  .display-none {
      display: none;
  }
</style>
<div id="getHeight">
<video id="liveplayer" class="video-js vjs-big-play-centered vjs-default-skin" controls>
    <source src="http://vjs.zencdn.net/v/oceans.mp4" type="video/mp4">
</video>
<div class="top">
    <div class="top-title">
        <p class="p1">aaaa只会因京东卡是--都看见爱上贷款卡SD卡大家阿萨德卡手机打开sdasd dsa sasdasdasdasd<p>
        <p class="p2"><span>未开始</span></p>
    </div>
    <div class="top-time">
        <p class="start-time">开播时间：6月6日21：00</p>
        <p class="room">房间号：1001010</p>
    </div>
</div>
<div class="middle">
    <span class="brief-introduction active-border" id="brief">简介</span>
    <span class="brief-introduction" id="interaction">互动</span>
    <div class="right">
        <span class="hot-img">
            <img class="img-css" src="~/Content/images/resume/noli.png"  />
            33333
        </span>
        <span class="hot-img">
            <img class="img-css" src="~/Content/images/resume/noli.png"  />
            33
        </span>
        <span class="hot-img">
            <img class="img-css" src="~/Content/images/resume/noli.png"  />
            333
        </span>
    </div>
</div>
</div>
<div class="article-padding">
    <div class="article">
        <div class="article-title">titletelteltletlelteltletlelte</div>
        <p class="article-text">证明文发发发撒大大是的大飒飒大师实打实大师大所大所多实打实大师大大阿大声道阿达阿达阿达阿达阿达大大大啊大大啊大大阿达大大大大大哒哒哒哒哒哒多多多多多多多多多多多多多多达到</p>
    </div>
</div>
<div class="talk_con display-none">
    <div class="talk_show" id="words">
        <div class="atalk"><span class="talk-name">other</span><span class="content">你还好吗？</span></div>
        <div class="btalk"><span class="talk-name">me</span><span class="content">嗯，你呢？</span></div>
    </div>
    <div class="talk_input">
        <input type="text" placeholder="请登录后发表评论" class="talk_word" id="talkwords">
        <input type="button" value="发送" class="talk_sub" id="talksub">
    </div>
</div>
<script src="~/Scripts/videojs7/video.min.js"></script>

<script>
    var live1Player;
    var live1Callback;
    var isPause = true;
    var live1urlObj = {};

    $(function () {
        // 简介与互动动态显示
        $("#brief").on("click",function(){
            $("#brief").addClass('active-border');         
            $("#interaction").removeClass('active-border'); 
            $('.article-padding').removeClass('display-none');         
            $('.talk_con').addClass('display-none');         
        });
        $("#interaction").on("click",function(){
            $("#interaction").addClass('active-border');         
            $("#brief").removeClass('active-border'); 
            $('.talk_con').removeClass('display-none');         
            $('.article-padding').addClass('display-none');         
        
        });

        // 聊天框
        var height = $(document).height() - $('#getHeight').height()-10;
        $('#words').css({'height':height});
        function insetHtml(from, name, vals) {
        var str = ""
        //选择A发送还是B发送
        if (from == 0) {
            str = '<div class="atalk"><span class="talk-name">'+name+'</span><span class="content">' + vals + '</span></div>'
        } else {
            str = '<div class="btalk"><span class="talk-name">'+name+'</span><span class="content">' + vals + '</span></div>'
        }
        //原有的内容+str,否则会覆盖掉原有内容
        $('#words').html($('#words').html() + str)
        //发送完数据后清空输入框
        $('#talkwords').val('')
        console.log($("#words")[0].scrollHeight)
        $("#words").scrollTop($("#words")[0].scrollHeight);
        }
        $('#talksub').click(function () {
        //发送单击，获取用户输入的数据value属性值
        var vals = $('#talkwords').val()
        //如果输入的数据为空，则弹窗提示
        if (vals == '') {
            alert('请输入数据！')
            return
        }
            insetHtml(1,'me', vals)
        })
        live1Player = videojs('liveplayer', { errorDisplay: false, controls: true,src:"" }, function () {
            var that = this
            $("#play").on("click",function(){
                that.play();          
            });

            // this.on('loadedmetadata', function () {
            //     //加载到元数据后开始播放视频
            //     $("#myError").hide();
            //     startVideo();
            // })
            // this.on('pause', function () {
            //     isPause = true;
            // })
            // this.on('play', function () {
            //     isPause = false;
            // })
            // this.on('error', function (e) {
            //     if (live1Callback != null)
            //         live1Callback('error');
            // })
        });
    });

    function updateLiveVideo(url, callback) {
        live1Callback = callback;

        if (url != null && url != '') {
            if (url.indexOf('rtmp') >= 0) {
                live1urlObj = { type: "rtmp/flv", src: url };
            }
            if (url.indexOf('m3u8') >= 0) {
                live1urlObj = { type: "application/x-mpegURL", src: url };
            }
            if (url.indexOf('flv') >= 0) {
                live1urlObj = { type: "video/x-flv", src: url };
            }
            if (url.indexOf('mp4') >= 0) {
                live1urlObj = { type: "video/mp4", src: url };
            }

            live1Player.src(live1urlObj);
        }
    };

    function playLive() {
        if (live1Player != null) {
            live1Player.src(live1urlObj);
            live1Player.play();
        }
    };

    var isVideoBreak;
    function startVideo() {
        //判断视频是否卡住，卡主3s重新load视频
        var lastTime = -1,
            tryTimes = 0;

        clearInterval(isVideoBreak);
        isVideoBreak = setInterval(function () {
            var currentTime = live1Player.currentTime();

            if (currentTime == lastTime) {
                //此时视频已卡主3s
                //设置当前播放时间为超时时间，此时videojs会在play()后把currentTime设置为0
                tryTimes++;

                //尝试5次播放后，如仍未播放成功提示刷新
                if (++tryTimes > 3) {
                    //alert('您的网速有点慢，刷新下试试');
                    if (live1Callback != null)
                        live1Callback();
                    tryTimes = 0;
                    live1Player.pause();
                } else {
                    live1Player.play();
                }
            } else {
                lastTime = currentTime;
                tryTimes = 0;
            }
        }, 3000)

    }

    function showWarning(txt) {
        if (txt == '' || txt == null)
            txt = '当前无直播';
        $("#myError p").html(txt);
        $("#myError").show();
    };

    function hideWarning() {
        $("#myError").hide();
    };

    //function updateVWatchedNumber(num) {
    //    $('#videoWatched').text(num);
    //};

    function hideLiveVideo() {
        if (isVideoBreak) {
            clearInterval(isVideoBreak);
        }
        if (live1Player != null)
            live1Player.pause();
        $('.live1-main').hide();
    };

    function showLiveVideo() {
        $('.live1-main').show();
    };

</script>