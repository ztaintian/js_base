@model CIIC.Hentai.Services.Dto.ViewModel.QuestionnaireViewModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>2020上海高校毕业生春季在线招聘会报名表 - 预才网</title>
    <meta name="viewport" id="viewport" content="width=device-width, user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta name="screen-orientation" content="portrait/landscape">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">

    <link href="~/Content/reset.css" rel="stylesheet" />
    <link href="//at.alicdn.com/t/font_1155283_oqir07rxqd.css" rel="stylesheet" />

    <script type="text/javascript" src="~/Scripts/jquery-mobile/jquery.1.11.1.min.js"></script>
    <script type="text/javascript" src="~/Scripts/Common/SetSize.js"></script>
    <script type="text/javascript" src="~/Scripts/Common/baidu.js"></script>
    <script type="text/javascript" src="~/Scripts/Common/vue.min.js"></script>
    <script src="~/Scripts/jquery.scrollTo.min.js"></script>

    <style>
        body {
            background-color: #ffffff;
        }

        .header {
            width: 100%;
        }
        .header img {
            width: 100%;
        }
        .introduction {
            margin: 0.6rem;
            padding: 0.6rem;
            border-radius: 0.2rem;
            border: dashed 0.05rem #b5b5b5;
        }
        .introduction .title {
            font-size: 0.725rem;
            text-align: center;
            line-height: 1.28rem;
        }
        .introduction .content {
            font-size: 0.6rem;
            text-align: left;
            line-height: 1.28rem;
        }
        .form_div {
            padding: 0.6rem 1.17rem;
        }
        .form-inline {
            position: relative;
        }
        .form-inline span {
            font-size: 0.64rem;
            color: #333333;
            line-height: 1.7rem;
            font-weight: bold;
        }
        .form-inline span.important {
            color:#ff0000;
        }
        .form-inline .empty {
            height: 0.768rem;
            background-color: #ff4242;
            color: #ffffff;
            font-size: 0.554rem;
            position: absolute;
            right: 0;
            padding: 0.1rem 0.2rem;
            border-radius: 0.2rem;
            top: 0.4rem;
        }
        .form-inline.error .empty {
            display: block;
        }
        html input,html select {
            border: solid 1px #afafaf;
            border-radius: 0.1rem;
            height: 1.7rem;
            width: 100%;
            box-sizing: border-box;
            padding: 0 0.5rem;
            color: #777777;
            font-size: 0.555rem;
        }
        ul li {
            color: #777777;
            font-size: 0.555rem;
            padding: 0 0.5rem;
            border: solid 1px #afafaf;
            border-bottom: none;
            border-radius: 0.1rem;
            height: 1.7rem;
            line-height: 1.7rem;
            position: relative;
        }
        ul.radiolist li i {
            position: absolute;
            right: 0.5rem;
            top: 0.1rem;
            display: none;
        }
        ul.radiolist li.active i {
            display: block;
        }
        ul.checkboxlist li i {
            position: absolute;
            right: 0.5rem;
            top: 0.1rem;
        }
        ul.checkboxlist li i.checkbox1 {
            display: block;
        }
        ul.checkboxlist li i.checkbox_selected {
            display: none;
        }
        ul.checkboxlist li.active i.checkbox1 {
            display: none;
        }
        ul.checkboxlist li.active i.checkbox_selected {
            display: block;
        }
        ul li:last-child {
            border-bottom: solid 1px #afafaf;
        }
        ul li input {
            border: none;
            position: absolute;
            width: 9rem;
        }
        .submit {
            padding: 0 1.17rem 1.152rem;
        }
        .submit span {
            font-size: 0.555rem;
            color: #333333;
            text-align: center;
            display: block;
            margin-bottom: 0.7rem;
        }
        .submit button {
            width: 100%;
            height: 1.7rem;
            line-height: 1.7rem;
            border-radius: 0.2rem;
            text-align: center;
            color: #ffffff;
            font-size: 0.64rem;
        }

        .success {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            padding: 3.2rem 0.6rem;
            box-sizing: border-box;
            text-align: center;
            display: none;
        }
        .success p {
            font-size: 0.64rem;
            color: #777777;
            margin-top: 1rem;
        }
        .success i {
            font-size: 7rem;
        }
        .success button {
            width: 100%;
            height: 1.7rem;
            line-height: 1.7rem;
            border-radius: 0.2rem;
            text-align: center;
            color: #ffffff;
            font-size: 0.64rem;
            margin-top: 3rem;
        }
        [v-cloak]{
            display: none
        }
        .text-area{
            border: solid 1px #afafaf;
            border-radius: 0.1rem;
            width: 100%;
            box-sizing: border-box;
            padding: 0.5rem;
            color: #777777;
            font-size: 0.555rem;
        }
    </style>
</head>
<body>
    <div class="baoming" id="vueApp" v-clock>
        <div class="header">
            <img src="~/Content/OnLineJobFairEnterpriseRegistration/header.png" />
        </div>
        <div class="introduction">
            <div class="title" style="color: #293da7;">标题</div>
            <div class="content" style="color: #293da7;">
                这是内容这是内容这是内容这是内容<br />这是内容这是内容<br />这是内容<br />这是内容
            </div>
        </div>
        <div class="form_div">
            <template v-for="(item,index) in dataList">
            <!-- 0:填空;1:单项选;2:多项选;3:下拉;4:多行文本; -->

                <!-- 填空 -->
                <div class="form-inline" id="question1" type="text" key="key1" v-if="item.SubjectType==0">
                    <div><span class="important" v-if="item.IsRequired">*</span><span :id="'scroll'+index">{{item.Subject}}</span></div>
                    <div class="empty" v-if="item.errorFlag">该项为必填项</div>
                    <input v-model="item.value" placeholder="请输入" />
                </div>

                <!-- 单项选 -->
                <div class="form-inline"  type="radio" key="key2" v-if="item.SubjectType==1">
                    <div><span class="important" v-if="item.IsRequired">*</span><span :id="'scroll'+index">{{item.Subject}}</span></div>
                    <div class="empty" v-if="item.errorFlag">{{item.tip}}</div>
                    <ul class="radiolist">
                        <li v-for="(itemChild,indexChild) in item.OptValue" :class="itemChild.activeFlag?'active':''" v-on:click="radioSelect(item,itemChild)">
                            {{String.fromCharCode(64 + parseInt(indexChild+1))}}、<template v-if="!itemChild.IsText">{{itemChild.Text}}</template><template v-else><span class="important" v-if="itemChild.IsRequired&&itemChild.activeFlag">*</span>{{itemChild.Text}}：<input v-model="itemChild.value"  placeholder="请自己填写" /></template>
                            <i class="iconfont radio"  style="color: #293da7;"></i>
                        </li>                    
                    </ul>
                </div>

                <!-- 多项选 -->
                <div class="form-inline" id="question4" type="checkbox" key="key4" v-if="item.SubjectType==2">
                    <div><span class="important" v-if="item.IsRequired">*</span><span :id="'scroll'+index">{{item.Subject}}</span></div>
                    <div class="empty" v-if="item.errorFlag">{{item.tip}}</div>
                    <ul class="checkboxlist">
                        <li value="国有企业" v-for="(itemChild,indexChild) in item.OptValue" :class="itemChild.activeFlag?'active':''" v-on:click="multipleChoice(item,itemChild,$event)"> {{String.fromCharCode(64 + parseInt(indexChild+1))}}、<template v-if="!itemChild.IsText">{{itemChild.Text}}</template><template v-else><span class="important" v-if="itemChild.IsRequired&&itemChild.activeFlag">*</span>{{itemChild.Text}}：<input v-model="itemChild.value" placeholder="请自己填写" /></template><i class="iconfont checkbox1" style="color: #293da7;"></i><i class="iconfont checkbox_selected" style="color: #293da7;"></i></li>
                    </ul>
                </div>

                <!-- 下拉 -->
                <div class="form-inline" id="question3" type="select" key="key3" v-if="item.SubjectType==3">
                    <div><span class="important" v-if="item.IsRequired">*</span><span :id="'scroll'+index">{{item.Subject}}</span></div>
                    <div class="empty" v-if="item.errorFlag">该项为必选项</div>
                    <select v-model="item.value">
                        <option disabled="disabled" value="">请选择</option>
                        <option v-for="(itemChild,indexChild) in item.OptValue" :value="itemChild.Text">{{itemChild.Text}}</option>
                    </select>
                </div>

                <!-- 多行文本 -->
                <div class="form-inline" id="question1" type="text" key="key1" v-if="item.SubjectType==4">
                    <div><span class="important" v-if="item.IsRequired" >*</span><span :id="'scroll'+index">{{item.Subject}}</span></div>
                    <div class="empty" v-if="item.errorFlag">该项为必填项</div>
                    <textarea v-model="item.value" placeholder="请输入" class="text-area"></textarea>
                </div>

            </template>
        </div>
        <div class="submit">
            <span style="color: #293da7;">感谢您的填写！工作人员将尽快与您取得联系！</span>
            <button style="background-color: #293da7;" v-on:click="signUp">报名参与</button>
        </div>
    </div>
    

    <div class="success">
        <i class="iconfont radio" style="color: #293da7;"></i>
        <p>您的报名信息已提交，谢谢您的参与！</p>
        <button style="background-color: #293da7;" v-on:click="signUp" >报名参与</button>
    </div>

    <script>
        var app = new Vue({
            el: '#vueApp',
            mounted() {
                 // 0:填空;1:单项选;2:多项选;3:下拉;4:多行文本;
                var question = eval(@Html.Raw(CIIC.Common.SerializeHelper.JsonSerialize(Model)));
                if (question.Subject.length > 0) {
                    question.Subject.map(function(item){
                        item.value = '';
                        item.errorFlag = false;
                        item.tip = '该项为必选项';
                        if ($.isArray(item.OptValue) && item.OptValue.length > 0) {
                            item.OptValue.map(function (itemC) {
                                itemC.activeFlag = false;
                                itemC.value = '';
                            })
                        }
                    })
                    this.dataList = question.Subject
                } 
            },
            methods:{
                radioSelect(item,itemChild,index) {
                    // 单选
                    item.value = '';
                    item.OptValue.map(function(value) {
                        value.activeFlag = false;
                    })
                    
                    itemChild.activeFlag = !itemChild.activeFlag;
                    if (itemChild.activeFlag) {
                        item.value = itemChild.Text
                    }
                },
                multipleChoice(item,itemChild,e) {
                    // 多选 其他§地方国企子公司〒上海闸北〒巨罗罗〒13680368177〒lo@ciicsh.com〒兼职¤全职
                    if (e.target.nodeName === 'INPUT') {
                        return;
                    }
                    var arr =[];
                    itemChild.activeFlag=!itemChild.activeFlag;
                    item.OptValue.map(function (value) {
                        if (value.activeFlag) {
                            if (value.IsText) {
                                value.value?arr.push(value.Text+'§'+value.value):arr.push(value.Text);;
                            } else {
                                arr.push(value.Text);
                            }
                        }
                    })
                    item.value = arr.join('¤');
                },
                signUp() {
                    // 报名参加
                    var that = this;
                    var id = '';
                    console.log('this.dataListthis.dataList', this.dataList)
                    this.dataList.map(function(value) {
                        if (value.IsRequired && !value.value) {
                            value.errorFlag = true;
                        } else {
                            value.errorFlag = false;
                        }
                        if (!value.errorFlag) {
                            if ($.isArray(value.OptValue) && value.OptValue.length > 0) {
                                value.OptValue.some(function (itemC) {
                                    if (itemC.activeFlag && itemC.IsText && itemC.IsRequired && !itemC.value) {
                                        value.errorFlag = true; 
                                        value.tip = '该项为必填项';
                                        return true;
                                    } else {
                                        value.errorFlag = false;  
                                    }
                                })
                            }
                        }
                        
                    })
                    var cc = this.dataList.some(function(value,index) {
                        if (value.IsRequired && !value.value) {
                            id = 'scroll' + index;
                            return true;
                        }
                    })
                    console.log('cc', id)
                    if (id) {
                        document.getElementById(id).scrollIntoView(true)
                    }
                    console.log(this.dataList)
                }
            },
            data() {
                return {
                    dataList: []
                }
            }
        })
        function submit() {
            var e = checkEmpty();
            console.log(e);

            //$.ajax({
            //    type: "POST",
            //    url: '/OnLineJobFairEnterpriseRegistration/SubEnterpriseRegistration',
            //    data: data,
            //    dataType: 'json',
            //    timeout: 30000,
            //    xhrFields: {
            //        withCredentials: true // 这里设置了withCredentials
            //    },
            //    success: function (message) {
            //        if (message.IsSuccess) {
            //            $('body').css('overflow', 'hidden');
            //            $('.baoming').hide();
            //            $('.success').show();
            //        }
            //    },
            //    error: function (xhr, type, error) {
            //    }
            //});
        };
    </script>

    <script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
    <script src="/Scripts/SDKShare.js"></script>
    <script>

    @*var weixinShare = new WeixinShare({
        title: '2020上海高校毕业生春季在线招聘会报名表',
            content: '前100位企业报名可免费获得“在线面试系统”、“电子签约服务”',
            linkUrl: location.href,
            imgUrl: location.protocol + '//' + document.domain + '/Content/OnLineJobFairEnterpriseRegistration/share.jpg',
            appId: '@ViewBag.JsParas.appId',
            debug: false,
            timestamp: '@ViewBag.JsParas.timestamp',
            nonceStr: '@ViewBag.JsParas.nonceStr',
            signature: '@ViewBag.JsParas.signature',
            shareAppMessageCancelCallback: function () {

            },
            shareTimelineCancelCallback: function () {

            },
            shareAppMessageSuccessCallback: function () {

            },
            shareTimelineSuccessCallback: function () {

            },
            shareQQSuccessCallback: function () {

            },
            shareWeiboSuccessCallback: function () {

            }
        });*@
    </script>
</body>
</html>